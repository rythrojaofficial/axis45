<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incident Report</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Noto Sans', Optima, Candara, source-sans-pro, sans-serif;
            }

        a {
            color: inherit;
            text-decoration: none;

        }
        body{
            margin:0;
        }

        :root {
            --primary-color: #263c42;
            --secondary-color: #bdd3b6;
            --background-gray: #e4e4e4;
            --links-hover: #3c702d; 
            --red:rgb(224, 79, 79);
        }
        body{
            display: grid;
            grid-template-columns: auto 95vw auto;
            margin-left: 0px;
            padding-left:0px;
            background-color: rgb(228, 228, 228);
        }
        select,
        fieldset,
        textarea,
        input,
        #form-submit{
            border-radius: .3rem;
            border: none;
            line-height: 1.5rem;
            margin: .25rem
        }
        select
        {
            background-color: white;
        }
        #form-submit{background-color: rgb(132, 240, 132);}
        #form-submit:hover{ background-color: rgb(19, 226, 25);}
        .form-wrapper{
            display: grid;
            grid-template-columns: auto 75vw auto;
        }

        .text-links{
            color:var(--primary-color);
        }
            .text-links a{
                color: inherit;
                font-weight: bold;
                text-decoration: none;
            }
            .text-links a:hover{
                text-decoration: underline;
                color: var(--links-hover)
            }

        .section {
            color: var(--primary-color);
            font-size: 175%;
            margin-top: 0px;
        }

        .please-fill{
            color: var(--red);
            font-size: .7rem;
        }
        :required{
            border: solid 2px rgb(224, 224, 174) ;
        }
    </style>
</head>
<body>
    
</body>
<script type="module" src="../../scripts/htmlElement.js"></script>
    <script type="module" src="./incident-report.js"></script>
    <script>
        let theForm = document.getElementById('the-form');
        let submitButton = document.getElementById('form-submit');
            submitButton.addEventListener('click', ()=>{
                document.querySelector('.please-fill').innerText = '';
                if(formValidation().numberValid > formValidation().totalRequiredMinus2radio - 0.5){
                    submitButton.style.display = 'none';
                    let submitMessage = document.getElementById('submit-message');
                        submitMessage.innerText = 'Submitting, please wait a few moments :)';

                    theForm.appendChild(submitMessage);
                }else {
                    document.querySelector('.please-fill').innerText = 
                    '*please check that all form elements are filled';
                }
                
            })

        function formValidation(){
            let nValids = 0;
            let theInputs = Array.from(document.querySelectorAll('input'));
                theInputs.push(document.querySelector('textarea'), document.querySelector('select'))
                // console.log(theInputs)
                for (let i = 0; i < theInputs.length; i++){
                    let x = theInputs[i];
                    
                    switch (true){
                        case(x.type === 'checkbox'
                            && x.checked):
                            nValids++
                            // console.log('checkbox')
                            break;
                        case(
                            (x.type === 'date'
                            ||x.id === 'input-name'
                            || x.type === 'select-one')
                            && x.value !== ''
                            ):
                            nValids++
                            // console.log('text, date, select')
                            break;                           
                        case (x.type === 'email'):
                            if (x.value.includes('@') &&
                                x.value.includes('.'))
                            nValids++
                            // console.log('email')
                            break;
                        case(x.type === 'radio'):
                            nValids += 1/3
                            // console.log('radio')
                            break;
                        case(x.type === 'textarea'
                            || x.id === 'input-instagram'):
                            nValids++;
                            // console.log('textarea')
                            break; 
                        default:
                            break;
                    }
                    
                }
                // console.log({'nvalids': nValids, 
                // 'totalrequiredminus2radio': theInputs.length - 2})
                
            return({
                'numberValid': Math.round(nValids),
                 'totalRequiredMinus2radio': theInputs.length - 2
            })
        }
        
    </script>
</html>